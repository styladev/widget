/*! Styla Widget v0.3.4 | (c) 2016 Styla GmbH | https://github.com/styladev/widget/blob/master/license.md */
!function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n?n:e)},d,d.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){(function(i){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;"undefined"!=typeof window?o=window:"undefined"!=typeof i?o=i:"undefined"!=typeof self&&(o=self),o.µ=e()}}(function(){return function t(n,i,o){function r(a,u){if(!i[a]){if(!n[a]){var f="function"==typeof e&&e;if(!u&&f)return f(a,!0);if(s)return s(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=i[a]={exports:{}};n[a][0].call(c.exports,function(e){var t=n[a][1][e];return r(t?t:e)},c,c.exports,t,n,i,o)}return i[a].exports}for(var s="function"==typeof e&&e,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){"use strict";var i="[object Microbe-Http]",o={},r=e("./version")+"-http";e("./modules/http")(o),Object.defineProperty(o,"version",{get:function(){return r}}),Object.defineProperty(o,"type",{get:function(){return i}}),t.exports=o},{"./modules/http":9,"./version":10}],2:[function(e,t,n){(function(e){function n(){for(;o.next;){o=o.next;var e=o.task;o.task=void 0;var t=o.domain;t&&(o.domain=void 0,t.enter());try{e()}catch(i){if(u)throw t&&t.exit(),setTimeout(n,0),t&&t.enter(),i;setTimeout(function(){throw i},0)}t&&t.exit()}s=!1}function i(t){r=r.next={task:t,domain:u&&e.domain,next:null},s||(s=!0,a())}var o={task:void 0,next:null},r=o,s=!1,a=void 0,u=!1;if("undefined"!=typeof e&&e.nextTick)u=!0,a=function(){e.nextTick(n)};else if("function"==typeof setImmediate)a="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var f=new MessageChannel;f.port1.onmessage=n,a=function(){f.port2.postMessage(0)}}else a=function(){setTimeout(n,0)};t.exports=i}).call(this,e("_process"))},{_process:3}],3:[function(e,t,n){function i(){}var o=t.exports={};o.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=i,o.addListener=i,o.once=i,o.off=i,o.removeListener=i,o.removeAllListeners=i,o.emit=i,o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){"use strict";t.exports=e("./lib/core.js"),e("./lib/done.js"),e("./lib/es6-extensions.js"),e("./lib/node-extensions.js")},{"./lib/core.js":5,"./lib/done.js":6,"./lib/es6-extensions.js":7,"./lib/node-extensions.js":8}],5:[function(e,t,n){"use strict";function i(e){function t(e){return null===u?void d.push(e):void s(function(){var t=u?e.onFulfilled:e.onRejected;if(null===t)return void(u?e.resolve:e.reject)(f);var n;try{n=t(f)}catch(i){return void e.reject(i)}e.resolve(n)})}function n(e){try{if(e===c)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void r(t.bind(e),n,i)}u=!0,f=e,a()}catch(o){i(o)}}function i(e){u=!1,f=e,a()}function a(){for(var e=0,n=d.length;n>e;e++)t(d[e]);d=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var u=null,f=null,d=[],c=this;this.then=function(e,n){return new c.constructor(function(i,r){t(new o(e,n,i,r))})},r(e,n,i)}function o(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function r(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(o){if(i)return;i=!0,n(o)}}var s=e("asap");t.exports=i},{asap:2}],6:[function(e,t,n){"use strict";var i=e("./core.js"),o=e("asap");t.exports=i,i.prototype.done=function(e,t){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(e){o(function(){throw e})})}},{"./core.js":5,asap:2}],7:[function(e,t,n){"use strict";function i(e){this.then=function(t){return"function"!=typeof t?this:new o(function(n,i){r(function(){try{n(t(e))}catch(o){i(o)}})})}}var o=e("./core.js"),r=e("asap");t.exports=o,i.prototype=o.prototype;var s=new i(!0),a=new i(!1),u=new i(null),f=new i(void 0),d=new i(0),c=new i("");o.resolve=function(e){if(e instanceof o)return e;if(null===e)return u;if(void 0===e)return f;if(e===!0)return s;if(e===!1)return a;if(0===e)return d;if(""===e)return c;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new o(t.bind(e))}catch(n){return new o(function(e,t){t(n)})}return new i(e)},o.all=function(e){var t=Array.prototype.slice.call(e);return new o(function(e,n){function i(r,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){i(r,e)},n)}t[r]=s,0===--o&&e(t)}catch(u){n(u)}}if(0===t.length)return e([]);for(var o=t.length,r=0;r<t.length;r++)i(r,t[r])})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){e.forEach(function(e){o.resolve(e).then(t,n)})})},o.prototype["catch"]=function(e){return this.then(null,e)}},{"./core.js":5,asap:2}],8:[function(e,t,n){"use strict";var i=e("./core.js"),o=e("asap");t.exports=i,i.denodeify=function(e,t){return t=t||1/0,function(){var n=this,o=Array.prototype.slice.call(arguments);return new i(function(i,r){for(;o.length&&o.length>t;)o.pop();o.push(function(e,t){e?r(e):i(t)});var s=e.apply(n,o);!s||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof s.then||i(s)})}},i.nodeify=function(e){return function(){var t=Array.prototype.slice.call(arguments),n="function"==typeof t[t.length-1]?t.pop():null,r=this;try{return e.apply(this,arguments).nodeify(n,r)}catch(s){if(null===n||"undefined"==typeof n)return new i(function(e,t){t(s)});o(function(){n.call(r,s)})}}},i.prototype.nodeify=function(e,t){return"function"!=typeof e?this:void this.then(function(n){o(function(){e.call(t,null,n)})},function(n){o(function(){e.call(t,n)})})}},{"./core.js":5,asap:2}],9:[function(e,t,n){t.exports=function(t){"use strict";var n=e("promise");t.http=function(e){var t,i,o,r,s,a,u,f;if(!e)return new Error("No parameters given");if("string"==typeof e&&(e={url:e}),t=new XMLHttpRequest,i=e.method||"GET",o=e.url,r=JSON.stringify(e.data)||null,s=e.user||"",a=e.password||"",u=e.headers||null,f="boolean"==typeof e.async?e.async:!0,t.onreadystatechange=function(){return 4===t.readyState?t:void 0},t.open(i,o,f,s,a),"POST"===i&&t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u)for(var d in u)t.setRequestHeader(d,u[d]);if(f)return new n(function(e,n){t.onerror=function(){n(new Error("Network error!"))},t.send(r),t.onload=function(){200===t.status?e(t.response):n(new Error(t.status))}});var c=function(e){var t={then:function(n){return 200===e.status&&n(e.responseText),t},"catch":function(n){return 200!==e.status&&n({status:e.status,statusText:e.statusText}),t}};return t};return t.send(r),t.onloadend=function(){return t.onreadystatechange(),c(t)},t.onloadend()},t.http.get=function(e){return this({url:e,method:"GET"})},t.http.post=function(e,t){return this({url:e,data:t,method:"POST"})}}},{promise:4}],10:[function(e,t,n){t.exports="0.5.2"},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./classes.js"),r=i(o),s=e("microbejs/dist/microbe.http.min"),a="#styla-widget p{margin:0}#styla-widget.styla-widget__wrapper{width:100%;height:100%}#styla-widget .styla-widget__container{box-sizing:border-box;position:relative;overflow:hidden;padding:1em 2em;height:100%;width:100%;min-height:14em;display:flex;flex-direction:column;flex-wrap:wrap;font-size:14px}#styla-widget .styla-widget__story{margin-bottom:1em;position:relative;flex-grow:1}#styla-widget .styla-widget__link{position:absolute;width:100%;display:flex;text-decoration:none;color:inherit}#styla-widget__link>div{display:inline-block}#styla-widget .styla-widget__image{object-fit:contain}#styla-widget .styla-widget__textwrap{display:block;flex-grow:1;max-height:100%;overflow:hidden;float:left}#styla-widget .styla-widget__headlinewrap{display:flex;flex-direction:column;justify-content:flex-end}#styla-widget .styla-widget__headline,#styla-widget .styla-widget__title{line-height:1.25em;max-height:2.5em;overflow:hidden}#styla-widget .styla-widget__title{font-size:2em;text-align:center;margin-bottom:30px}#styla-widget .styla-widget__paragraph{font-size:1em;line-height:1.5em;overflow:hidden;position:relative;word-wrap:break-word}",u="#styla-widget .styla-widget__story{margin-right:2em;height:14em;width:100%}#styla-widget .styla-widget__story:nth-child(even){text-align:right}#styla-widget .styla-widget__link{height:14em;top:50%;margin-top:-7em;align-items:center}#styla-widget .styla-widget__imagewrap{display:block;vertical-align:top;flex-grow:1;height:100%;margin:0 6% 0 0;flex:none;max-width:40%;float:left}#styla-widget .styla-widget__story:nth-child(even) .styla-widget__imagewrap{margin:0 0 0 6%;float:right;clear:both;order:2}#styla-widget .styla-widget__image{height:100%;max-width:100%;max-height:100%}#styla-widget .styla-widget__textwrap{display:block;flex-grow:1;max-height:100%;overflow:hidden;float:left}#styla-widget .styla-widget__story:nth-child(even) .styla-widget__textwrap{float:right}#styla-widget .styla-widget__headlinewrap{height:5em;display:flex;flex-direction:column;justify-content:flex-end}#styla-widget .styla-widget__headline{font-size:1.9em;line-height:1.25em;max-height:2.5em;overflow:hidden;margin:0 0 .25em;word-wrap:break-word;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}#styla-widget .styla-widget__paragraph{font-size:1em;line-height:1.5em;max-height:calc(100% - 5em);overflow:hidden;position:relative;word-wrap:break-word}#styla-widget .styla-widget__paragraph:after{position:absolute;left:0;top:7.5em;display:block;background-color:#FFF;width:100%;height:2em}#styla-widget .styla-widget__paragraph p+p{display:none}",f="styla-widget",d=function(e){console.log("err",e)},c=void 0,l=void 0,p=0,h={buildHeadline:function(e){var t=h.create,n=t("div",r["default"].HEADLINE_WRAPPER),i=t("h3",r["default"].HEADLINE);return i.textContent=e,n.appendChild(i),n},buildImage:function(e,t,n){c=c||n;var i=h.create,o=i("div",r["default"].IMAGE_WRAPPER),s=c.size,a=e[0].id,u=c.images[a],f=i("img",r["default"].IMAGE);return f.src=h.getImageUrl(u.fileName,s),f.alt=u.caption||t,f.title=t,o.appendChild(f),o},buildStories:function(e,t){if(l=t||JSON.parse(e),0===Object.keys(l).length)throw"Styla Widget error: Could not find magazine, please check if slug is configured correctly.";h.setDomain(),h.includeBaseStyles();var n={},i=c.stories,o=i.images;if(o){o.forEach(function(e){n[e.id]=e}),c.images=n;var r=(i.stories.map(h.buildStory),h.compileStyles());document.head.appendChild(r),c.target.appendChild(c.wrapper)}return c.wrapper},buildStory:function(e,t){var n=e.title,i=e.description,o=e.images,s=e.externalPermalink,a=e.id;if(c.ignore+""!=a+""&&t-p<c.limit){var u=h.create,f=u("div",r["default"].STORY),d=u("a",r["default"].STORY_LINK);d.href="//"+c.domain+"/story/"+s+"/",c.newTab?d.setAttribute("target","_blank"):c.iframe&&d.setAttribute("target","_top"),f.appendChild(d),d.appendChild(h.buildImage(o,n)),d.appendChild(h.buildStoryText(n,i));var l=c.container;return l.appendChild(f),c.wrapper.appendChild(l),f}p++},buildStoryText:function(e,t){var n=h.create,i=n("div",r["default"].TEXT_WRAPPER),o=h.buildHeadline(e);i.appendChild(o);var s=n("div",r["default"].PARAGRAPH);return s.innerHTML=h.getDescription(JSON.parse(t)),s.innerHTML=s.textContent,i.appendChild(s),i},buildStyleTag:function(e){var t=document.createElement("style");t.type="text/css",t.className=r["default"].STYLES;var n=document.createTextNode(e);return t.appendChild(n),t},compileStyles:function(){var e=l.theme,t="";if(e){"."+r["default"].HEADLINE+", ."+r["default"].TITLE+"\n                {\n                    font-family:        "+e.hff+";\n                    font-weight:        "+e.hfw+";\n                    font-style:         "+e.hfs+";\n                    text-decoration:    "+e.htd+";\n                    letter-spacing:     "+e.hls+";\n                    color:              "+e.htc+";\n                }\n                ."+r["default"].PARAGRAPH+"\n                {\n                    font-family:        "+e.sff+";\n                    font-weight:        "+e.sfw+";\n                    color:              "+e.stc+";\n                }\n                ."+r["default"].PARAGRAPH+":after\n                {\n                    content:            '"+e.strm+"';\n                    font-weight:        "+e.strmw+";\n                    text-decoration:    "+e.strmd+";\n                }"}var n=h.buildStyleTag(t);return n.className=r["default"].THEME_STYLES+"  styla-widget__"+c.seed,n},create:function(e,t){var n=document.createElement(e.toUpperCase());return t&&(n.className=t),n},getDescription:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=e[t];return n?"text"!==n.type?h.getDescription(e,t+1):n.content:!1},getDomainConfig:function(e){c=this,c.stories=JSON.parse(e);var t=c.container=h.create("DIV",r["default"].CONTAINER);if(c.title){var n=c.title,i=c.title=h.create("DIV",r["default"].TITLE);i.innerHTML=n+"<hr>",t.appendChild(i)}var o=c.wrapper=h.create("DIV",r["default"].WRAPPER+"  styla-widget__"+c.seed);o.id=f;var a="https://live.styla.com/api/config/";return s.http.get(a+c.slug).then(h.buildStories)["catch"](d),t},getImageUrl:function(e){var t=arguments.length<=1||void 0===arguments[1]?400:arguments[1];return"//img.styla.com/resizer/sfh_"+t+"x0/_"+e+"?still"},includeBaseStyles:function(){var e=document.head,t=h.buildStyleTag(a+u);return t.className=r["default"].BASE_STYLES+"  styla-widget__"+c.seed,e.appendChild(t),l.embed.customFontUrl&&h.includeFonts(e),t},includeFonts:function(){var e=document.createElement("link");return e.type="text/css",e.rel="stylesheet",e.href=l.embed.customFontUrl,document.head.appendChild(e),e},setDomain:function(){var e=l.embed;if(c.linkDomain)return c.domain=c.linkDomain;if(e)return c.domain=e.magazineUrl+"/"+e.rootPath;throw"Styla Widget error: No domain defined or bad domain config"}};n["default"]=h,t.exports=n["default"]},{"./classes.js":3,"microbejs/dist/microbe.http.min":1}],3:[function(e,t,n){"use strict";t.exports={BASE_STYLES:"styla-widget__base-styling",CONTAINER:"styla-widget__container",HEADLINE:"styla-widget__headline",HEADLINE_WRAPPER:"styla-widget__headlinewrap",IMAGE:"styla-widget__image",IMAGE_WRAPPER:"styla-widget__imagewrap",PARAGRAPH:"styla-widget__paragraph",STORY:"styla-widget__story",STORY_LINK:"styla-widget__link",STYLES:"styla-widget__styling",TEXT_WRAPPER:"styla-widget__textwrap",THEME_STYLES:"styla-widget__theme-styling",TITLE:"styla-widget__title",WRAPPER:"styla-widget__wrapper"}},{}],4:[function(e,t,n){"use strict";t.exports="0.3.4"},{}],5:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=e("./version.js"),a=(i(s),e("./build.js")),u=i(a),f=e("microbejs/dist/microbe.http.min"),d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.api,i=void 0===n?"https://live.styla.com":n,r=t.iframe,s=void 0===r?!1:r,a=t.ignore,d=void 0===a?!1:a,c=t.limit,l=void 0===c?5:c,p=t.linkDomain,h=void 0===p?!1:p,y=t.newTab,w=void 0===y?!1:y,v=t.offset,g=void 0===v?0:v,m=t.size,b=void 0===m?400:m,_=t.storiesApi,E=void 0===_?!1:_,T=t.slug,x=void 0===T?!1:T,S=t.tag,A=void 0===S?!1:S,j=t.target,P=void 0===j?document.body:j,R=t.title,C=void 0===R?!1:R;if(o(this,e),"string"==typeof P&&(P=document.querySelector(P)),"undefined"==typeof P||null===P)console.error("Styla Widget error: Cant find target element in DOM. Widget will render directly in body"),P=document.body;else{if(P.offsetWidth<250)throw"Styla Widget error: Target element too small to render widget ¯\\_(ツ)_/¯";if(!x)throw"Styla Widget error: No slug defined, cannot render widget"}this.seed=Date.now(),this.api=i,this.linkDomain=h,this.iframe=s,this.ignore=d;var N=d?1:0;this.limit=l,this.newTab=w,this.offset=g,this.size=b,this.slug=x,this.storiesApi=E,this.tag=A,this.target=P,this.title=C;var I=A?i+"/api/feeds/tags/"+A+"?offset="+g+"&limit="+(l+N)+"&domain="+x:i+"/api/feeds/user/"+x+"?domain="+x+"&offset="+g+"&limit="+(l+N);return f.http.get(E||I).then(u["default"].getDomainConfig.bind(this)),this}return r(e,[{key:"destroy",value:function(){var e=document.querySelectorAll(".styla-widget__"+this.seed);return Array.prototype.forEach.call(e,function(e){e.parentNode.removeChild(e)}),this.wrapper}}]),e}();window.StylaWidget=d;var c="function"==typeof window.onload?window.onload:function(){};window.onload=function(e){window.stylaWidget&&(window.stylaWidget=new d(window.stylaWidget)),c(e)},n["default"]=d,t.exports=n["default"]},{"./build.js":2,"./version.js":4,"microbejs/dist/microbe.http.min":1}]},{},[5]);