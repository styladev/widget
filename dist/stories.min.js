/*! Styla Widget v0.4.5 | (c) 2016 Styla GmbH | https://github.com/styladev/widget/blob/master/license.md */
!function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return r(n?n:t)},l,l.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){(function(i){!function(t){if("object"==typeof n&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof i?r=i:"undefined"!=typeof self&&(r=self),r.µ=t()}}(function(){return function e(n,i,r){function o(s,u){if(!i[s]){if(!n[s]){var f="function"==typeof t&&t;if(!u&&f)return f(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[s]={exports:{}};n[s][0].call(d.exports,function(t){var e=n[s][1][t];return o(e?e:t)},d,d.exports,e,n,i,r)}return i[s].exports}for(var a="function"==typeof t&&t,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,e,n){"use strict";var i="[object Microbe-Http]",r={},o=t("./version")+"-http";t("./modules/http")(r),Object.defineProperty(r,"version",{get:function(){return o}}),Object.defineProperty(r,"type",{get:function(){return i}}),e.exports=r},{"./modules/http":9,"./version":10}],2:[function(t,e,n){(function(t){function n(){for(;r.next;){r=r.next;var t=r.task;r.task=void 0;var e=r.domain;e&&(r.domain=void 0,e.enter());try{t()}catch(i){if(u)throw e&&e.exit(),setTimeout(n,0),e&&e.enter(),i;setTimeout(function(){throw i},0)}e&&e.exit()}a=!1}function i(e){o=o.next={task:e,domain:u&&t.domain,next:null},a||(a=!0,s())}var r={task:void 0,next:null},o=r,a=!1,s=void 0,u=!1;if("undefined"!=typeof t&&t.nextTick)u=!0,s=function(){t.nextTick(n)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var f=new MessageChannel;f.port1.onmessage=n,s=function(){f.port2.postMessage(0)}}else s=function(){setTimeout(n,0)};e.exports=i}).call(this,t("_process"))},{_process:3}],3:[function(t,e,n){function i(){}var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=i,r.addListener=i,r.once=i,r.off=i,r.removeListener=i,r.removeAllListeners=i,r.emit=i,r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],4:[function(t,e,n){"use strict";e.exports=t("./lib/core.js"),t("./lib/done.js"),t("./lib/es6-extensions.js"),t("./lib/node-extensions.js")},{"./lib/core.js":5,"./lib/done.js":6,"./lib/es6-extensions.js":7,"./lib/node-extensions.js":8}],5:[function(t,e,n){"use strict";function i(t){function e(t){return null===u?void l.push(t):void a(function(){var e=u?t.onFulfilled:t.onRejected;if(null===e)return void(u?t.resolve:t.reject)(f);var n;try{n=e(f)}catch(i){return void t.reject(i)}t.resolve(n)})}function n(t){try{if(t===d)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void o(e.bind(t),n,i)}u=!0,f=t,s()}catch(r){i(r)}}function i(t){u=!1,f=t,s()}function s(){for(var t=0,n=l.length;n>t;t++)e(l[t]);l=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");var u=null,f=null,l=[],d=this;this.then=function(t,n){return new d.constructor(function(i,o){e(new r(t,n,i,o))})},o(t,n,i)}function r(t,e,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=i}function o(t,e,n){var i=!1;try{t(function(t){i||(i=!0,e(t))},function(t){i||(i=!0,n(t))})}catch(r){if(i)return;i=!0,n(r)}}var a=t("asap");e.exports=i},{asap:2}],6:[function(t,e,n){"use strict";var i=t("./core.js"),r=t("asap");e.exports=i,i.prototype.done=function(t,e){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(t){r(function(){throw t})})}},{"./core.js":5,asap:2}],7:[function(t,e,n){"use strict";function i(t){this.then=function(e){return"function"!=typeof e?this:new r(function(n,i){o(function(){try{n(e(t))}catch(r){i(r)}})})}}var r=t("./core.js"),o=t("asap");e.exports=r,i.prototype=r.prototype;var a=new i(!0),s=new i(!1),u=new i(null),f=new i(void 0),l=new i(0),d=new i("");r.resolve=function(t){if(t instanceof r)return t;if(null===t)return u;if(void 0===t)return f;if(t===!0)return a;if(t===!1)return s;if(0===t)return l;if(""===t)return d;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new r(e.bind(t))}catch(n){return new r(function(t,e){e(n)})}return new i(t)},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function i(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){i(o,t)},n)}e[o]=a,0===--r&&t(e)}catch(u){n(u)}}if(0===e.length)return t([]);for(var r=e.length,o=0;o<e.length;o++)i(o,e[o])})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){t.forEach(function(t){r.resolve(t).then(e,n)})})},r.prototype["catch"]=function(t){return this.then(null,t)}},{"./core.js":5,asap:2}],8:[function(t,e,n){"use strict";var i=t("./core.js"),r=t("asap");e.exports=i,i.denodeify=function(t,e){return e=e||1/0,function(){var n=this,r=Array.prototype.slice.call(arguments);return new i(function(i,o){for(;r.length&&r.length>e;)r.pop();r.push(function(t,e){t?o(t):i(e)});var a=t.apply(n,r);!a||"object"!=typeof a&&"function"!=typeof a||"function"!=typeof a.then||i(a)})}},i.nodeify=function(t){return function(){var e=Array.prototype.slice.call(arguments),n="function"==typeof e[e.length-1]?e.pop():null,o=this;try{return t.apply(this,arguments).nodeify(n,o)}catch(a){if(null===n||"undefined"==typeof n)return new i(function(t,e){e(a)});r(function(){n.call(o,a)})}}},i.prototype.nodeify=function(t,e){return"function"!=typeof t?this:void this.then(function(n){r(function(){t.call(e,null,n)})},function(n){r(function(){t.call(e,n)})})}},{"./core.js":5,asap:2}],9:[function(t,e,n){e.exports=function(e){"use strict";var n=t("promise");e.http=function(t){var e,i,r,o,a,s,u,f;if(!t)return new Error("No parameters given");if("string"==typeof t&&(t={url:t}),e=new XMLHttpRequest,i=t.method||"GET",r=t.url,o=JSON.stringify(t.data)||null,a=t.user||"",s=t.password||"",u=t.headers||null,f="boolean"==typeof t.async?t.async:!0,e.onreadystatechange=function(){return 4===e.readyState?e:void 0},e.open(i,r,f,a,s),"POST"===i&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u)for(var l in u)e.setRequestHeader(l,u[l]);if(f)return new n(function(t,n){e.onerror=function(){n(new Error("Network error!"))},e.send(o),e.onload=function(){200===e.status?t(e.response):n(new Error(e.status))}});var d=function(t){var e={then:function(n){return 200===t.status&&n(t.responseText),e},"catch":function(n){return 200!==t.status&&n({status:t.status,statusText:t.statusText}),e}};return e};return e.send(o),e.onloadend=function(){return e.onreadystatechange(),d(e)},e.onloadend()},e.http.get=function(t){return this({url:t,method:"GET"})},e.http.post=function(t,e){return this({url:t,data:e,method:"POST"})}}},{promise:4}],10:[function(t,e,n){e.exports="0.5.2"},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(n,"__esModule",{value:!0});var r=t("./classes.js"),o=i(r),a=t("microbejs/dist/microbe.http.min"),s="#styla-widget p{margin:0}#styla-widget.styla-widget__wrapper{width:100%;height:100%}#styla-widget .styla-widget__container{box-sizing:border-box;position:relative;overflow:hidden;height:100%;width:100%;min-height:14em;display:flex;flex-direction:column;flex-wrap:wrap;font-size:14px}#styla-widget .styla-widget__story{margin-bottom:1em;position:relative;flex-grow:1}#styla-widget .styla-widget__link{position:absolute;width:100%;display:flex;text-decoration:none;color:inherit}#styla-widget__link>div{display:inline-block}#styla-widget .styla-widget__image{max-height:100%;max-width:100%;height:100%;object-fit:contain}#styla-widget .styla-widget__textwrap{display:block;flex-grow:1;max-height:100%;overflow:hidden;float:left}#styla-widget .styla-widget__headlinewrap{display:flex;flex-direction:column;justify-content:flex-end}#styla-widget .styla-widget__headline,#styla-widget .styla-widget__title{line-height:1.25em;max-height:2.5em;overflow:hidden}#styla-widget .styla-widget__title{font-size:2em;text-align:center;margin-bottom:30px}#styla-widget .styla-widget__paragraph{font-size:1em;line-height:1.5em;overflow:hidden;position:relative;word-wrap:break-word}",u="#styla-widget .styla-widget__story{overflow:hidden;height:5em}#styla-widget .styla-widget__link{height:5em}#styla-widget__link>div{display:inline-block}#styla-widget .styla-widget__image,#styla-widget .styla-widget__imagewrap{width:85px}#styla-widget .styla-widget__imagewrap{margin:0 3% 0 0;height:100%}#styla-widget .styla-widget__textwrap{width:calc(100% - 85px);display:block;flex-grow:1;max-height:100%;overflow:hidden;float:left}#styla-widget .styla-widget__headlinewrap{height:2em;display:flex;flex-direction:column;justify-content:flex-end}#styla-widget .styla-widget__headline,#styla-widget .styla-widget__title{font-size:1.4em;line-height:1.25em;max-height:2.5em;overflow:hidden;margin:0 0 .25em;word-wrap:break-word;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}#styla-widget .styla-widget__title{font-size:2em;text-align:center;margin-bottom:60px;padding:30px 0;border-bottom:#E5E5E5 solid 1px}#styla-widget .styla-widget__paragraph{font-size:1em;line-height:1.5em;height:3em;overflow:hidden;position:relative;word-wrap:break-word;text-overflow:ellipsis}#styla-widget .styla-widget__paragraph:after{position:absolute;left:0;top:7.5em;display:block;background-color:#FFF;width:100%;height:2em}",f="styla-widget",l=function(t){console.log("err",t)},d=void 0,c=void 0,p=0,h={buildHeadline:function(t){var e=h.create,n=e("div",o["default"].HEADLINE_WRAPPER),i=e("h3",o["default"].HEADLINE);return i.textContent=t,n.appendChild(i),n},buildImage:function(t,e,n){d=d||n;var i=h.create,r=i("div",o["default"].IMAGE_WRAPPER),a=d.imageSize,s=t[0].id,u=d.images[s],f=h.getImageUrl(u.fileName,a),l=i("img",o["default"].IMAGE);return l.src=f,l.alt=u.caption||e,l.title=e,r.appendChild(l),r},buildStories:function(t,e){if(c=e||JSON.parse(t),0===Object.keys(c).length)throw"Styla Widget error: Could not find magazine, please check if slug is configured correctly.";h.setDomain(),h.includeBaseStyles();var n={},i=d.stories,r=i.images;if(r){d.title=h.buildTitle(),r.forEach(function(t){n[t.id]=t}),d.images=n;var o=(i.stories.map(h.buildStory),h.compileStyles());document.head.appendChild(o),d.target.appendChild(d.wrapper)}return d.wrapper},buildStory:function(t,e){var n=t.title,i=t.description,r=t.images,a=t.externalPermalink,s=t.id;if(d.ignore+""!=s+""&&e-p<d.limit){var u=h.create,f=u("div",o["default"].STORY),l=u("a",o["default"].STORY_LINK);l.href="//"+d.domain+"/story/"+a+"/",d.newTab?l.setAttribute("target","_blank"):d.iframe&&l.setAttribute("target","_top"),f.appendChild(l),l.appendChild(h.buildImage(r,n)),l.appendChild(h.buildStoryText(n,i));var c=d.container;return c.appendChild(f),d.wrapper.appendChild(c),f}p++},buildStoryText:function(t,e){var n=h.create,i=n("div",o["default"].TEXT_WRAPPER),r=h.buildHeadline(t);i.appendChild(r);var a=n("div",o["default"].PARAGRAPH);return e=h.getDescription(JSON.parse(e)),e&&(a.innerHTML=e,a.innerHTML=a.textContent),i.appendChild(a),i},buildStyleTag:function(t){var e=document.createElement("style");e.type="text/css",e.className=o["default"].STYLES;var n=document.createTextNode(t);return e.appendChild(n),e},buildTitle:function(){if(d.title===!0&&c.title&&(d.title=c.title),d.title){var t=d.title,e=d.title=h.create("DIV",o["default"].TITLE);e.innerHTML=t,d.container.appendChild(e)}return d.title},compileStyles:function(){var t=c.theme,e="";t&&(e="."+o["default"].HEADLINE+", ."+o["default"].TITLE+"\n                {\n                    font-family:        "+t.hff+";\n                    font-weight:        "+t.hfw+";\n                    font-style:         "+t.hfs+";\n                    text-decoration:    "+t.htd+";\n                    letter-spacing:     "+t.hls+";\n                    color:              "+t.htc+";\n                }\n                ."+o["default"].PARAGRAPH+"\n                {\n                    font-family:        "+t.sff+";\n                    font-weight:        "+t.sfw+";\n                    color:              "+t.stc+";\n                }\n                ."+o["default"].PARAGRAPH+":after\n                {\n                    content:            '"+t.strm+"';\n                    font-weight:        "+t.strmw+";\n                    text-decoration:    "+t.strmd+";\n                }");var n=h.buildStyleTag(e);return n.className=""+o["default"].THEME_STYLES,d.els.themeStyle=n,n},create:function(t,e){var n=document.createElement(t.toUpperCase());return e&&(n.className=e),n},getDescription:function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=t[e];return n?"text"!==n.type?h.getDescription(t,e+1):n.content:!1},getDomainConfig:function(t){d=this,d.stories=JSON.parse(t);var e=d.container=h.create("DIV",o["default"].CONTAINER),n=d.wrapper=h.create("DIV",o["default"].WRAPPER);d.els.wrapper=n,n.id=f;var i="https://live.styla.com/api/config/";return a.http.get(i+d.slug).then(h.buildStories)["catch"](l),e},getImageUrl:function(t){var e=arguments.length<=1||void 0===arguments[1]?400:arguments[1];return"//img.styla.com/resizer/sfh_"+e+"x0/_"+t+"?still"},includeBaseStyles:function(){var t=document.head,e=h.buildStyleTag(s+u);return e.className=""+o["default"].BASE_STYLES,d.els.baseStyle=e,t.appendChild(e),c.embed.customFontUrl&&h.includeFonts(t),e},includeFonts:function(){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet";var e=c.embed.customFontUrl;return t.href=-1!==e.indexOf("//")?e:"//"+e,document.head.appendChild(t),t},setDomain:function(){var t=c.embed;if(d.domain)return d.domain;if(d.linkDomain)return d.domain=d.linkDomain;if(t)return d.domain=t.magazineUrl+"/"+t.rootPath;throw"Styla Widget error: No domain defined or bad domain config"}};n["default"]=h,e.exports=n["default"]},{"./classes.js":3,"microbejs/dist/microbe.http.min":1}],3:[function(t,e,n){"use strict";e.exports={BASE_STYLES:"styla-widget__base-styling",CONTAINER:"styla-widget__container",HEADLINE:"styla-widget__headline",HEADLINE_WRAPPER:"styla-widget__headlinewrap",IMAGE:"styla-widget__image",IMAGE_WRAPPER:"styla-widget__imagewrap",PARAGRAPH:"styla-widget__paragraph",STORY:"styla-widget__story",STORY_LINK:"styla-widget__link",STYLES:"styla-widget__styling",TEXT_WRAPPER:"styla-widget__textwrap",THEME_STYLES:"styla-widget__theme-styling",TITLE:"styla-widget__title",WRAPPER:"styla-widget__wrapper"}},{}],4:[function(t,e,n){"use strict";e.exports="0.4.5"},{}],5:[function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=t("./version.js"),s=(i(a),t("./build.js")),u=i(s),f=t("microbejs/dist/microbe.http.min"),l=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.api,i=void 0===n?"https://live.styla.com":n,o=e.domain,a=void 0===o?!1:o,s=e.iframe,l=void 0===s?!1:s,d=e.ignore,c=void 0===d?!1:d,p=e.limit,h=void 0===p?5:p,y=e.linkDomain,v=void 0===y?!1:y,m=e.minWidth,w=void 0===m?250:m,g=e.newTab,b=void 0===g?!1:g,E=e.offset,T=void 0===E?0:E,_=e.imageSize,x=void 0===_?400:_,S=e.storiesApi,j=void 0===S?!1:S,A=e.slug,P=void 0===A?!1:A,R=e.tag,C=void 0===R?!1:R,N=e.target,k=void 0===N?document.body:N,I=e.title,L=void 0===I?!1:I;if(r(this,t),k=this.checkTarget(k,w),!P)throw"Styla Widget error: No slug defined, cannot render widget";this.els={},this.api=i,this.domain=a,this.linkDomain=v,this.iframe=l,this.ignore=c;this.limit=h,this.minWidth=w,this.newTab=b,this.offset=T,this.imageSize=x,this.slug=P,this.storiesApi=j,this.tag=C,this.target=k,this.title=L;var O=i+"/api/feeds/all?domain="+P+"&offset="+T+"&limit="+h;return f.http.get(j||O).then(u["default"].getDomainConfig.bind(this)),this}return o(t,[{key:"attach",value:function(){var t=arguments.length<=0||void 0===arguments[0]?this.target:arguments[0];t=this.checkTarget(t,this.minWidth);var e=this.els,n=document.head;return e.baseStyle&&(n.appendChild(e.baseStyle),n.appendChild(e.themeStyle),t.appendChild(e.wrapper)),this}},{key:"checkTarget",value:function(t,e){if("string"==typeof t)return document.querySelector(t);if("undefined"==typeof t||null===t)return console.error("Styla Widget error: Cant find target element in DOM. Widget will render directly in body"),document.body;if(t.offsetWidth<e)throw"Styla Widget error: Target element too small to render widget ¯\\_(ツ)_/¯";return t}}]),o(t,[{key:"destroy",value:function(){var t=this.els;return Object.keys(t).forEach(function(e){var n=t[e],i=n.parentNode;i&&i.removeChild(n)}),this}}]),t}();window.StylaWidget=l;var d="function"==typeof window.onload?window.onload:function(){};window.onload=function(t){window.stylaWidget&&(window.stylaWidget=new l(window.stylaWidget)),d(t)},n["default"]=l,e.exports=n["default"]},{"./build.js":2,"./version.js":4,"microbejs/dist/microbe.http.min":1}]},{},[5]);